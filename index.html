<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>The Game of Lowlife</title>
<style>
  :root{--bg:#0b0b0e;--ink:#f5f5f7;--muted:#b7b7c2;--accent:#ffd54f;--border:#2a2a35;--card:#15161d}
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui, Arial, sans-serif;display:flex;flex-direction:column;min-height:100vh}

  header{display:flex;align-items:center;justify-content:center;gap:12px;padding:8px 14px;border-bottom:1px solid var(--border);background:#111}
  header img{max-height:72px;display:block}
  header h1{margin:0;font-weight:900;letter-spacing:1px;display:none;color:var(--accent)}

  #app{display:flex;flex-direction:column;flex:1;min-height:0}
  #topbar{flex:0 0 auto;position:sticky;top:0;z-index:50;background:var(--bg);border-bottom:1px solid var(--border)}
  #controls{max-width:1200px;margin:0 auto;padding:8px;display:flex;flex-wrap:wrap;gap:10px;align-items:center}
  .btn{background:#e53935;color:#fff;border:none;border-radius:10px;padding:10px 14px;font-weight:700;cursor:pointer}
  .btn:disabled{opacity:.6;cursor:not-allowed}
  input,select{background:#1b1b22;border:1px solid var(--border);color:#fff;border-radius:8px;padding:8px}
  label{color:var(--muted);font-size:.9rem}
  #status{color:var(--accent)}

  /* --- SPINNER FIX --- */
  #spinnerWrap{display:flex;align-items:center;gap:8px;margin-left:auto}
  #spinner-container{position:relative;width:100px;height:100px}
  #spinner-wheel{position:relative;width:100%;height:100%;border-radius:50%;
    background:conic-gradient(
      #FF0000 0% 10%, #FF7F00 10% 20%, #FFFF00 20% 30%, #00FF00 30% 40%,
      #0000FF 40% 50%, #4B0082 50% 60%, #8B00FF 60% 70%, #FFC0CB 70% 80%,
      #F08080 80% 90%, #FFD700 90% 100%
    );
    box-shadow:0 0 12px rgba(0,0,0,0.6);
    transform-origin:center center;
    transition:transform 4s cubic-bezier(.25,.46,.45,.94);
  }
  .spinner-number{
    position:absolute;
    left:50%;
    top:50%;
    transform-origin:0 -42px; /* perfect radial alignment */
    font-weight:900;
    font-size:12px;
    color:#000;
    text-shadow:0 0 2px #fff;
    pointer-events:none;
  }
  #arrow{
    position:absolute;
    top:-10px;
    left:50%;
    transform:translateX(-50%);
    width:0;height:0;
    border-left:6px solid transparent;
    border-right:6px solid transparent;
    border-bottom:14px solid #fff;
    z-index:5;
  }

  #main{display:flex;flex-direction:column;flex:1;min-height:0}
  #boardArea{flex:1;min-height:0;overflow:auto}
  #track{max-width:1200px;margin:8px auto;display:grid;grid-template-columns:repeat(20, 1fr);gap:4px}
  .cell{min-height:44px;border:1px solid var(--border);background:#202028;color:#ddd;font-size:.7rem;display:flex;align-items:center;justify-content:center;text-align:center;border-radius:8px;padding:3px}
  .cell small{display:block;color:#cfcfcf;font-size:.6rem;margin-top:2px}
  .cell.start{background:#1b5e20}
  .cell.finish{background:#0d47a1}
  .cell.payday{background:#2e7d32;color:#fff;font-weight:800}
  .cell.tard{background:#5a189a}
  .cell.bankruptcy{background:#b71c1c}
  .cell.lottery{background:#795548}
  .cell.idtheft{background:#263238}
  .cell.extortion{background:#4e342e}
  .cell.active{outline:3px dashed #ffd54f}

  #playersDock{flex:0 0 170px;border-top:1px solid var(--border);background:#0e0e12}
  #players{height:100%;max-width:1200px;margin:0 auto;padding:8px;display:flex;gap:12px;overflow:auto}
  .card{min-width:260px;background:var(--card);border:1px solid var(--border);border-radius:12px;padding:10px}
  .title{font-weight:900;margin-bottom:6px}
  .mono{font-variant-numeric:tabular-nums}
  .delta{font-size:.8rem;color:#9ccc65;margin-left:6px}
  #log{display:none}
</style>
</head>
<body>
<header>
  <img id="logo" src="lowlife logo.jpg" alt="The Game of Lowlife">
  <h1>The Game of Lowlife</h1>
</header>

<div id="app">
  <section id="topbar">
    <div id="controls">
      <div id="lobbyControls" style="display:flex; flex-wrap:wrap; gap:10px;">
        <button id="createGameBtn" class="btn" type="button">Create Game</button>
        <label>Game Code:
          <input id="gameCodeInput" type="text" placeholder="Enter Code" maxlength="4" style="width:100px;">
        </label>
        <button id="joinGameBtn" class="btn" type="button">Join Game</button>
      </div>

      <div id="gameLobby" style="display:none; flex-wrap:wrap; gap:10px; align-items:center;">
          <span style="color:var(--accent); font-weight:700;">Invite Code: <span id="displayGameCode"></span></span>
      </div>
      <label>Players:
        <select id="numPlayers" disabled> <option>2</option><option>3</option><option>4</option>
          <option>5</option><option>6</option><option>7</option><option>8</option>
        </select>
      </label>
      <button id="buildNames" class="btn" type="button" disabled>Set Names</button>
      <div id="namesRow" style="display:flex;flex-wrap:wrap;gap:8px"></div>
      <button id="startBtn" class="btn" type="button" disabled>Start Game</button>
      <button id="spinBtn" class="btn" type="button" disabled>SPIN</button>
      <label>Voice: <select id="voiceSel"></select></label>
      <span style="color:#aaa">TARD deck: <span id="deckCount"></span></span>
      <span id="status">Enter names, then Start Game.</span>

      <div id="spinnerWrap" title="Spin result is read aloud">
        <div id="spinner-container">
          <div id="spinner-wheel"></div>
          <div id="arrow"></div>
        </div>
      </div>
    </div>
  </section>

  <section id="main">
    <section id="boardArea">
      <div id="track"></div>
    </section>
    <section id="playersDock">
      <div id="players"></div>
    </section>
  </section>
</div>

<section id="log"></section>

<!-- SOCKET.IO -->
<script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
<script>
  const socket = io("https://lowlife-server-1.onrender.com", { path:"/socket.io", transports:["websocket","polling"] });

  // --- Spinner numbers (centered) ---
  const spinnerWheel = document.getElementById("spinner-wheel");
  if (spinnerWheel) {
    // Clear any old numbers
    document.querySelectorAll(".spinner-number").forEach(e => e.remove());
    for (let i = 0; i < 10; i++) {
      const num = document.createElement("div");
      num.className = "spinner-number";
      num.textContent = i + 1;
      num.style.transform = `rotate(${i * 36}deg)`;
      spinnerWheel.appendChild(num);
    }
  }
</script>

<!-- Your existing game JavaScript continues below this comment -->
</body>
</html>
